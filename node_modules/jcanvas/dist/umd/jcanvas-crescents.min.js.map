{"version":3,"file":"jcanvas-crescents.min.js","sources":["../../src/jcanvas-crescents.ts"],"sourcesContent":["/**\n * @license jCanvas Crescents\n * Copyright 2013-2024 Caleb Evans\n * Released under the MIT license\n */\nimport $ from \"jquery\";\n\n// Cache some functions and constants\nconst pow = Math.pow,\n\tsqrt = Math.sqrt,\n\tPI = Math.PI;\n\n// Get the topmost intersection point of two circles\nfunction getIntersection(\n\tx0: number,\n\ty0: number,\n\tr0: number,\n\tx1: number,\n\ty1: number,\n\tr1: number\n): [number, number] | null {\n\tconst dx = x1 - x0,\n\t\tdy = y1 - y0,\n\t\td = sqrt(pow(dx, 2) + pow(dy, 2)),\n\t\ta = (pow(d, 2) + pow(r0, 2) - pow(r1, 2)) / (2 * d),\n\t\tx2 = x0 + (dx * a) / d,\n\t\ty2 = y0 + (dy * a) / d,\n\t\th = sqrt(pow(r0, 2) - pow(a, 2)),\n\t\trx = -dy * (h / d),\n\t\try = dx * (h / d),\n\t\txi = x2 + rx,\n\t\tyi = y2 + ry;\n\n\t// Check if circles do not intersect or overlap completely\n\tif (d > r0 + r1 || d < Math.abs(r0 - r1)) {\n\t\treturn null;\n\t}\n\treturn [xi, yi];\n}\n\n$.jCanvas.extend({\n\tname: \"drawCrescent\",\n\ttype: \"crescent\",\n\tprops: {\n\t\teclipse: 0.5,\n\t},\n\tfn: function (ctx, params) {\n\t\tconst dist = 2 * params.radius * (1 - params.eclipse);\n\t\tconst intersection = getIntersection(\n\t\t\tparams.x,\n\t\t\tparams.y,\n\t\t\tparams.radius,\n\t\t\tparams.x + dist,\n\t\t\tparams.y,\n\t\t\tparams.radius\n\t\t);\n\t\tif (!intersection) {\n\t\t\treturn;\n\t\t}\n\t\tconst x = intersection[0] - params.x;\n\t\tconst y = intersection[1] - params.y;\n\t\tconst t = Math.atan2(y, x);\n\t\tlet start: number;\n\t\tlet end: number;\n\n\t\tif (params.eclipse <= 0) {\n\t\t\t// Show full circle if circle is not eclipsed\n\t\t\tstart = 0;\n\t\t\tend = 2 * PI;\n\t\t} else {\n\t\t\t// Otherwise, show eclipsed circle\n\t\t\tstart = t;\n\t\t\tend = -t;\n\t\t}\n\n\t\t// If circle is not fully eclipsed\n\t\tif (params.eclipse < 1) {\n\t\t\t// Draw crescent shape\n\n\t\t\t// Enable shape transformation\n\t\t\t$.jCanvas.transformShape(this, ctx, params);\n\n\t\t\tctx.beginPath();\n\t\t\t// Draw full circle\n\t\t\tctx.arc(params.x, params.y, params.radius, start, end, false);\n\t\t\t// If circle is eclipsed to some degree\n\t\t\tif (params.eclipse > 0) {\n\t\t\t\t// Draw crescent region in circle\n\t\t\t\tctx.arc(\n\t\t\t\t\tparams.x + dist,\n\t\t\t\t\tparams.y,\n\t\t\t\t\tparams.radius,\n\t\t\t\t\tPI + start,\n\t\t\t\t\tPI + end,\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t}\n\t\t\t// Enable jCanvas events\n\t\t\t$.jCanvas.detectEvents(this, ctx, params);\n\t\t\t// Always close path\n\t\t\tparams.closed = true;\n\t\t\t$.jCanvas.closePath(this, ctx, params);\n\t\t}\n\t},\n});\n"],"names":["pow","sqrt","PI","getIntersection","x0","y0","r0","x1","y1","r1","dx","dy","d","a","x2","y2","h","rx","ry","xi","yi","$","ctx","params","dist","intersection","x","y","t","start","end"],"mappings":"+NAQA,MAAMA,EAAM,KAAK,IAChBC,EAAO,KAAK,KACZC,EAAK,KAAK,GAGX,SAASC,EACRC,EACAC,EACAC,EACAC,EACAC,EACAC,EAC0B,CAC1B,MAAMC,EAAKH,EAAKH,EACfO,EAAKH,EAAKH,EACVO,EAAIX,EAAKD,EAAIU,EAAI,CAAC,EAAIV,EAAIW,EAAI,CAAC,CAAC,EAChCE,GAAKb,EAAIY,EAAG,CAAC,EAAIZ,EAAIM,EAAI,CAAC,EAAIN,EAAIS,EAAI,CAAC,IAAM,EAAIG,GACjDE,EAAKV,EAAMM,EAAKG,EAAKD,EACrBG,EAAKV,EAAMM,EAAKE,EAAKD,EACrBI,EAAIf,EAAKD,EAAIM,EAAI,CAAC,EAAIN,EAAIa,EAAG,CAAC,CAAC,EAC/BI,EAAK,CAACN,GAAMK,EAAIJ,GAChBM,EAAKR,GAAMM,EAAIJ,GACfO,EAAKL,EAAKG,EACVG,EAAKL,EAAKG,EAGX,OAAIN,EAAIN,EAAKG,GAAMG,EAAI,KAAK,IAAIN,EAAKG,CAAE,EAC/B,KAED,CAACU,EAAIC,CAAE,CACf,CAEAC,EAAE,QAAQ,OAAO,CAChB,KAAM,eACN,KAAM,WACN,MAAO,CACN,QAAS,EACV,EACA,GAAI,SAAUC,EAAKC,EAAQ,CAC1B,MAAMC,EAAO,EAAID,EAAO,QAAU,EAAIA,EAAO,SACvCE,EAAetB,EACpBoB,EAAO,EACPA,EAAO,EACPA,EAAO,OACPA,EAAO,EAAIC,EACXD,EAAO,EACPA,EAAO,MACR,EACA,GAAI,CAACE,EACJ,OAED,MAAMC,EAAID,EAAa,CAAC,EAAIF,EAAO,EAC7BI,EAAIF,EAAa,CAAC,EAAIF,EAAO,EAC7BK,EAAI,KAAK,MAAMD,EAAGD,CAAC,EACzB,IAAIG,EACAC,EAEAP,EAAO,SAAW,GAErBM,EAAQ,EACRC,EAAM,EAAI5B,IAGV2B,EAAQD,EACRE,EAAM,CAACF,GAIJL,EAAO,QAAU,IAIpBF,EAAE,QAAQ,eAAe,KAAMC,EAAKC,CAAM,EAE1CD,EAAI,UAAU,EAEdA,EAAI,IAAIC,EAAO,EAAGA,EAAO,EAAGA,EAAO,OAAQM,EAAOC,EAAK,EAAK,EAExDP,EAAO,QAAU,GAEpBD,EAAI,IACHC,EAAO,EAAIC,EACXD,EAAO,EACPA,EAAO,OACPrB,EAAK2B,EACL3B,EAAK4B,EACL,EACD,EAGDT,EAAE,QAAQ,aAAa,KAAMC,EAAKC,CAAM,EAExCA,EAAO,OAAS,GAChBF,EAAE,QAAQ,UAAU,KAAMC,EAAKC,CAAM,EAEvC,CACD,CAAC"}